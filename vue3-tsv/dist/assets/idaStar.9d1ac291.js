var Z=Object.defineProperty;var tt=(g,t,e)=>t in g?Z(g,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[t]=e;var T=(g,t,e)=>(tt(g,typeof t!="symbol"?t+"":t,e),e);import{d as et,u as ot,e as st,l as D,c as L,p as c,w as h,a as _,T as nt,U as M,V,r as P,o as U,k as m,t as N,j as at,F as it,g as rt,S as ut,v as lt,x as ct}from"./common.80d79def.js";import{a as z,N as dt,A as W,B as R,b as ht}from"./idaStar.ec5f304a.js";import"./shared/chartGraph/idaStar.9fc57de2.js";import{_ as mt}from"./about.45dbf088.js";import"./chartGraph.a9c4b756.js";import"./shared/aStar/chartGraph.723c646f.js";class Y{constructor(){T(this,"history",{});T(this,"historyArr",[]);T(this,"board",new dt)}init(t,e,n){this.clear(),this.board.setSize(t,e),n&&this.board.setList(n)}clear(){this.history={},this.historyArr=[]}execInit(){const t={list:this.board.list,state:this.board.listStr,action:W.d,beforeState:""};this.history[t.state]=t,this.historyArr.push(t.state)}async exec(t){console.log("exec");const e=Date.now();let n=0,i=e,u=0,a;if(this.board.checkFinish())return[];this.execInit();for(const{h:p}of this.execStep()){if(!this.history[p.state]&&(this.history[p.state]=p,this.historyArr.push(p.state),p.state==this.board.finishStr)){a=p;break}u+=1;const d=Date.now();if(d-i>1e3)throw new Error(`\u6B21\u8BA1\u7B97\u65F6\u95F4\u8FC7\u957F${d-i}ms`);if(i=d,u%3e5==0){const F=Date.now()-e,w=`\u5DF2\u904D\u5386${u/1e6}M,\u8017\u65F6${(F/1e3).toFixed(3)}s...`;console.log(w),t&&t(w),await new Promise(b=>{setTimeout(b,0)})}}if(!a)throw new Error("\u8FD8\u539F\u5931\u8D25");const o=this.getPath();n=Date.now();const f=n-e;return console.log(`Done:\u8FD8\u539F\u8DEF\u5F84${o.length}\u6B65,\u904D\u5386\u72B6\u6001${(this.historyArr.length/10**6).toFixed(3)}M,\u8017\u65F6${(f/1e3).toFixed(3)}s,\u5343\u6B21\u8017\u65F6${(f*1e3/this.historyArr.length).toFixed(3)}ms`),o}*execStep(){for(let t=0;t<this.historyArr.length;t++){const e=this.history[this.historyArr[t]];this.board.setList(e.list,!1);const n=this.board.getCanActoinDir(this.board.emptyIndex,e.beforeState?e.action:void 0),i=this.board.listStr;for(const u of n){const a=this.board.doAction(u,!1),o=a.join(",");yield{h:{list:a,state:o,action:u,beforeState:i},i:t}}}}getPath(t){const e=t||this.historyArr[this.historyArr.length-1],n=this.historyArr[0];let i=this.history[e];const u=[i];for(;i.state!==n;)i=this.history[i.beforeState],u.push(i);return u.pop(),u.reverse().map(o=>o.action)}}class ft{constructor(){T(this,"boardBfs",new Y);T(this,"rBoardBfs",new Y)}init(t,e,n){this.boardBfs.init(t,e,n),this.rBoardBfs.init(t,e)}clear(){this.boardBfs.clear(),this.rBoardBfs.clear()}async exec(t){console.log("exec");const e=Date.now();let n=0,i=e,u=0,a;this.boardBfs.execInit(),this.rBoardBfs.execInit();const o=this.boardBfs.execStep(),f=this.rBoardBfs.execStep();function p(w,b,k){const{value:x,done:E}=w.next();if(!x||E)throw new Error("\u8FD8\u539F\u5931\u8D25");const{h:v,i:y}=x;return b.history[v.state]||(b.history[v.state]=v,b.historyArr.push(v.state),k.history[v.state]&&(a=v)),y}for(;!a&&(p(o,this.boardBfs,this.rBoardBfs),!(a||(p(f,this.rBoardBfs,this.boardBfs),a)));){const w=Date.now();if(w-i>2200)throw new Error(`\u6B21\u8BA1\u7B97\u65F6\u95F4\u8FC7\u957F${w-i}ms`);if(i=w,u+=1,u%3e5==0){const b=Date.now()-e,k=`\u5DF2\u904D\u5386${u/1e6}M,\u8017\u65F6${(b/1e3).toFixed(3)}s...`;console.log(k),t&&t(k),await new Promise(x=>{setTimeout(x,0)})}}if(!a)throw new Error("\u8FD8\u539F\u5931\u8D25");const d=this.getPath(a.state);n=Date.now();const F=n-e;return console.log(`Done:\u8FD8\u539F\u8DEF\u5F84${d.length}\u6B65,\u904D\u5386\u72B6\u6001${this.boardBfs.historyArr.length},\u8017\u65F6${(F/1e3).toFixed(3)}s,\u5343\u6B21\u8017\u65F6${(F*1e3/this.boardBfs.historyArr.length).toFixed(3)}ms`),d}getPath(t){const e=this.boardBfs.getPath(t);let n=this.rBoardBfs.getPath(t);return n=n.reverse().map(i=>this.boardBfs.board.reverseDir[i]),console.log(z(e),z(n)),e.concat(n)}}class pt{constructor(){T(this,"astar",new R);T(this,"rAstar",new R)}init(t,e,n){this.astar.init(t,e,n),this.rAstar.init(t,e),this.rAstar.setFinishList(n)}clear(){this.astar.clear(),this.rAstar.clear()}async exec(t){console.log("exec");const e=Date.now();let n=0,i=e,u=0,a=0,o;this.astar.execInit(),this.rAstar.execInit();const f=this.astar.execStep(),p=this.rAstar.execStep();function d(x,E,v){const{value:y,done:B}=x.next();if(B)throw new Error("\u8FD8\u539F\u5931\u8D25");(y==E.board.finishStr||v.haveState(y))&&(o=y)}if(this.astar.board.listStr==this.astar.board.finishStr)o=this.astar.board.listStr;else for(;!o&&(d(f,this.astar,this.rAstar),!(o||(d(p,this.rAstar,this.astar),o)));){const x=Date.now();a+=1;const E=Date.now()-e;if(x-i>500){i=x;const v=`\u5DF2\u904D\u5386${a/1e6}M,\u8017\u65F6${(E/1e3).toFixed(3)}s,\u5343\u6B21\u8017\u65F6${(E*1e3/a).toFixed(3)}ms...`;console.log(v),t&&t(v),await new Promise(y=>{setTimeout(y,0)})}u+=1,u>1e6&&(this.removeTest(),u=0)}if(!o)throw new Error("\u8FD8\u539F\u5931\u8D25");const F=this.getPath(o);n=Date.now();const w=n-e,b=this.astar.openQueue.size()+Object.keys(this.astar.closeSet).length+this.rAstar.openQueue.size()+Object.keys(this.rAstar.closeSet).length+this.astar.remoceCnt+this.rAstar.remoceCnt,k=this.astar.remoceCnt+this.rAstar.remoceCnt;return console.log(`Done:\u8FD8\u539F\u8DEF\u5F84${F.length}\u6B65,\u904D\u5386\u72B6\u6001${(b/10**6).toFixed(3)}M,\u6E05\u7406\u5185\u5B58${k}\u6761,\u8017\u65F6${(w/1e3).toFixed(3)}s,\u5343\u6B21\u8017\u65F6${(w*1e3/b).toFixed(3)}ms`),F}getPath(t){const e=this.astar.getPath(t);let n=this.rAstar.getPath(t);return n=n.reverse().map(i=>this.rAstar.board.reverseDir[i]),console.log(this.rAstar.board.actoins2Str(e),this.rAstar.board.actoins2Str(n)),e.concat(n)}removeTest(){this.astar.removeTest(),this.rAstar.removeTest()}}const I=g=>(lt("data-v-948a7f68"),g=g(),ct(),g),vt={class:"component-component_name"},_t=m("\u786E\u5B9A"),gt=m(),wt=I(()=>_("br",null,null,-1)),bt=m(" 4*5\u4EE5\u4E0A\u9762\u677F\u76EE\u524D\u4E16\u754C\u65E0\u89E3 "),xt={class:"shuffle-cfg"},yt=m("\u751F\u6210\u6253\u4E71\u6B65\u9AA4"),Bt={class:"do-actino-info"},Ft=m(" doActinoInfo:"),At=I(()=>_("br",null,null,-1)),St=I(()=>_("br",null,null,-1)),Ct=I(()=>_("br",null,null,-1)),Dt=m("\u9010\u6B65\u6267\u884C"),kt=m(),Et=m("\u7ACB\u5373\u6267\u884C"),$t=I(()=>_("br",null,null,-1)),Tt=m("\u590D\u4F4D"),It=m(),Pt=m("\u8BBE\u7F6E\u9762\u677F"),Nt=I(()=>_("br",null,null,-1)),Lt=m("Bi-bfs\u6C42\u89E3"),Ut=I(()=>_("br",null,null,-1)),zt=m("Bi-A* \u6C42\u89E3"),Mt=I(()=>_("br",null,null,-1)),Gt=m(" \u8BF7\u786E\u8BA4\u8F93\u5165\u7684\u72B6\u6001\u662F\u53EF\u89E3\u7684 "),jt={key:0},Vt={key:1},Wt=et({__name:"idaStar",props:{},emits:[],setup(g,{emit:t}){async function e(r){return new Promise(s=>setTimeout(s,r))}ot(),st();const n=D({widthCnt:4,heightCnt:4}),i=D({itemWidth:30,gep:4,widthCnt:4,heightCnt:4,emptyIndex:-1,emptyNum:-1}),u=D({step:i.value.widthCnt*i.value.heightCnt*2}),a=D({actions:[],actionsStr:"",execed:0,currentAction:0,lock:!1}),o=new ht(i.value),f=D(o.list),p=D(o.emptyNum);o.list=f.value;const d=D({dialog:!1,listStr:""});function F(){o.setSize(n.value.widthCnt,n.value.heightCnt),p.value=o.emptyNum,f.value=o.list,o.list=f.value,u.value.step=o.widthCnt*o.heightCnt*3}function w(){o.reset(),f.value=o.list,o.list=f.value}function b(){d.value.dialog=!0}function k(){try{o.setList(d.value.listStr,!0,!0),d.value.dialog=!1}catch(r){throw V.warning(r.message),r}}function x(){const r=o.getRandomActions(u.value.step);a.value.actionsStr=z(r)}function E(r){const s=r.toLowerCase().split(/[,\s]+/).filter(S=>S),A=s.findIndex((S,C,j)=>!["u","d","l","r"].includes(S));return A>=0?(V.warning(`\u65E0\u6548\u6267\u884C\u52A8\u4F5C\u7B2C'${A+1}'\u9879\uFF1A${s[A]}`),!1):s.map(S=>W[S])}async function v(r=!1){if(!!a.value.actionsStr){a.value.lock=!0;try{const s=E(a.value.actionsStr);if(!s)return;a.value.actions=s;for(let A in s)a.value.currentAction=s[A],a.value.execed=Number(A),o.doAction(a.value.currentAction),r||await e(250)}catch(s){throw V.warning(s.message),s}finally{a.value.lock=!1}}}const y=new ft,B=D({str:"",style:""});async function q(){B.value={str:"",style:""};try{y.init(o.widthCnt,o.heightCnt,o.list);const r=await y.exec(s=>B.value.str="info:"+s);B.value.str=`step:${r.length} `+z(r)}catch(r){throw B.value.str="error:"+r.message,B.value.style="color:red",r}finally{y.clear()}}async function O(r){!/step:/.test(r)||(r=r.replace(/step:\d+ /,""),a.value.actionsStr=r,await navigator.clipboard.writeText(r))}const G=new pt,$=D({str:"",style:""});async function H(){$.value={str:"",style:""};try{G.init(o.widthCnt,o.heightCnt,o.list);const r=await G.exec(s=>$.value.str="info:"+s);$.value.str=`step:${r.length} `+z(r)}catch(r){throw $.value.str="error:"+r.message,$.value.style="color:red",r}finally{G.clear()}}return(r,s)=>{const A=P("a-input"),S=P("a-form-item"),C=P("a-button"),j=P("a-form"),J=P("a-input-number"),Q=P("a-textarea"),K=P("a-modal");return U(),L("div",vt,[c(j,{model:i.value,"label-col":{span:10},disabled:a.value.lock},{default:h(()=>[c(S,{label:"widthCnt",name:"widthCnt"},{default:h(()=>[c(A,{value:n.value.widthCnt,"onUpdate:value":s[0]||(s[0]=l=>n.value.widthCnt=l)},null,8,["value"])]),_:1}),c(S,{label:"heightCnt",name:"heightCnt"},{default:h(()=>[c(A,{value:n.value.heightCnt,"onUpdate:value":s[1]||(s[1]=l=>n.value.heightCnt=l)},null,8,["value"])]),_:1}),c(S,null,{default:h(()=>[c(C,{onClick:F},{default:h(()=>[_t]),_:1}),gt,wt,bt]),_:1})]),_:1},8,["model","disabled"]),_("div",null,[c(j,{disabled:a.value.lock},{default:h(()=>[_("div",xt,[c(J,{value:u.value.step,"onUpdate:value":s[2]||(s[2]=l=>u.value.step=l),precision:0},null,8,["value"]),c(C,{onClick:x},{default:h(()=>[yt]),_:1})]),_("div",Bt,[Ft,At,c(Q,{value:a.value.actionsStr,"onUpdate:value":s[3]||(s[3]=l=>a.value.actionsStr=l)},null,8,["value"]),St,m(" exec: "+N(at(W)[a.value.currentAction])+" "+N(a.value.execed+1)+"/"+N(a.value.actions.length),1),Ct,c(C,{onClick:s[4]||(s[4]=l=>v())},{default:h(()=>[Dt]),_:1}),kt,c(C,{onClick:s[5]||(s[5]=l=>v(!0))},{default:h(()=>[Et]),_:1}),$t,c(C,{onClick:w},{default:h(()=>[Tt]),_:1}),It,c(C,{onClick:b},{default:h(()=>[Pt]),_:1}),Nt,c(C,{onClick:q},{default:h(()=>[Lt]),_:1}),Ut,_("div",{class:"solve",style:M(B.value.style),onClick:s[6]||(s[6]=l=>O(B.value.str))},N(B.value.str),5),c(C,{onClick:H},{default:h(()=>[zt]),_:1}),Mt,_("div",{class:"solve",style:M($.value.style),onClick:s[7]||(s[7]=l=>O($.value.str))},N($.value.str),5)])]),_:1},8,["disabled"]),c(K,{open:d.value.dialog,"onUpdate:open":s[9]||(s[9]=l=>d.value.dialog=l),title:"Basic Modal",onOk:k},{default:h(()=>[c(Q,{value:d.value.listStr,"onUpdate:value":s[8]||(s[8]=l=>d.value.listStr=l)},null,8,["value"]),Gt]),_:1},8,["open"])]),_("div",{class:"cube",style:M({width:(i.value.itemWidth+i.value.gep)*i.value.widthCnt+"px"})},[c(nt,{name:"cube-item"},{default:h(()=>[(U(!0),L(it,null,rt(f.value,(l,X)=>(U(),L("div",{key:l,class:ut(["item","item-"+(p.value==l?"none":l),X==l?"match":""]),style:M({width:i.value.itemWidth+"px",height:i.value.itemWidth+"px",margin:i.value.gep/2+"px"})},[typeof l=="number"?(U(),L("span",jt,N(l+1),1)):(U(),L("span",Vt,N(l),1))],6))),128))]),_:1})],4)])}}});var Kt=mt(Wt,[["__scopeId","data-v-948a7f68"]]);export{Kt as default};
